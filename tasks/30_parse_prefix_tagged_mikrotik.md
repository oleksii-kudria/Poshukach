# üß© –ó–∞–≤–¥–∞–Ω–Ω—è 30 ‚Äî –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –ø—Ä–µ—Ñ—ñ–∫—Å–æ–≤–∞–Ω–∏—Ö DHCP-–ª–æ–≥—ñ–≤ (`dhcp,info <TAG>:`) —ñ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è client‚Äë—Ä—è–¥–∫—ñ–≤

## üéØ –ú–µ—Ç–∞
–ù–∞–≤—á–∏—Ç–∏ –ø–∞—Ä—Å–µ—Ä –æ–±—Ä–æ–±–ª—è—Ç–∏ —â–µ –æ–¥–∏–Ω —Ñ–æ—Ä–º–∞—Ç –≤—Ö—ñ–¥–Ω–∏—Ö —Ä—è–¥–∫—ñ–≤, –¥–µ –ø—ñ—Å–ª—è `dhcp,info` —ñ–¥–µ **—Ç–µ–∫—Å—Ç–æ–≤–∏–π –ø—Ä–µ—Ñ—ñ–∫—Å‚Äë—Ç–µ–≥** —Ç–∞ –¥–≤–æ–∫—Ä–∞–ø–∫–∞, –Ω–∞–ø—Ä.:
```
dhcp,info 3CC_: server-guest assigned 192.168.1.108 for FF:EE:DD:CC:BB:AA S24-FE
dhcp,info 3CC_: dhcp-client on ether2 got IP address 192.168.1.223
```
- **–ü–æ—Ç—Ä—ñ–±–Ω–æ –ø—Ä–æ–ø—É—Å–∫–∞—Ç–∏** —Ä—è–¥–∫–∏ –≤–∏–¥—É `dhcp-client on <iface> got IP address <ip>` (—Å–ª—É–∂–±–æ–≤—ñ –ø–æ–¥—ñ—ó –∫–ª—ñ—î–Ω—Ç–∞).
- **–ü–æ—Ç—Ä—ñ–±–Ω–æ –ø–∞—Ä—Å–∏—Ç–∏** —Ä—è–¥–∫–∏ –≤–∏–¥–∞—á—ñ –∞–¥—Ä–µ—Å–∏ —Å–µ—Ä–≤–µ—Ä–æ–º: `<dhcpName> assigned <IP> (for|to) <MAC> [<NAME>]`,
  –¥–µ `<dhcpName>` –º–æ–∂–µ –±—É—Ç–∏ **–±—É–¥—å-—è–∫–∏–º** (`server-guest`, `dhcp1`, `dhcp-guest`, ‚Ä¶).

---

## üß© –î–µ—Ç–∞–ª—ñ —Ñ–æ—Ä–º–∞—Ç—É
1) **–ü—Ä–µ—Ñ—ñ–∫—Å‚Äë—Ç–µ–≥** ‚Äî –±—É–¥—å‚Äë—è–∫–∏–π –Ω–µ–ø–æ—Ä–æ–∂–Ω—ñ–π —Ä—è–¥–æ–∫ –±–µ–∑ –¥–≤–æ–∫—Ä–∞–ø–∫–∏ –ø—ñ—Å–ª—è `dhcp,info`, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ `3CC_`, –∑–∞ —è–∫–∏–º —ñ–¥–µ `:` —ñ –ø—Ä–æ–±—ñ–ª. –ü—Ä–∏–∫–ª–∞–¥–∏:
   - `dhcp,info 3CC_: ‚Ä¶`
   - `dhcp,info myTag123: ‚Ä¶`
2) –ü—ñ—Å–ª—è –ø—Ä–µ—Ñ—ñ–∫—Å–∞ —ñ–¥–µ **–∫–æ—Ä–∏—Å–Ω–∞ —á–∞—Å—Ç–∏–Ω–∞** ‚Äî –∞–±–æ —Å–ª—É–∂–±–æ–≤–∏–π client‚Äë—Ä—è–¥–æ–∫, –∞–±–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ `assigned`.

---

## ‚öôÔ∏è –ó–∞–≤–¥–∞–Ω–Ω—è —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó

### 1) –†–æ–∑—à–∏—Ä–∏—Ç–∏ –¥–µ—Ç–µ–∫—Ç–æ—Ä ¬´—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ¬ª —Ñ–æ—Ä–º–∞—Ç—É
- –î–æ–¥–∞—Ç–∏ –æ–±—Ä–æ–±–∫—É **–æ–ø—Ü—ñ–π–Ω–æ–≥–æ** –ø—Ä–µ—Ñ—ñ–∫—Å–∞: `^dhcp,info\s+([^:]+):\s+(?P<body>.*)$`
  - –Ø–∫—â–æ –∑–±—ñ–≥ ‚Äî –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –¥–∞–ª—ñ –∑ `body` —è–∫ –∑ ¬´—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–º¬ª DHCP‚Äë—Ä—è–¥–∫–æ–º.
  - –Ø–∫—â–æ –∑–±—ñ–≥ **–Ω–µ** –≤—ñ–¥–±—É–≤—Å—è ‚Äî –∑–∞–ª–∏—à–∏—Ç–∏ —á–∏–Ω–Ω—É –≥—ñ–ª–∫—É –±–µ–∑ –ø—Ä–µ—Ñ—ñ–∫—Å–∞.

### 2) –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è —Å–ª—É–∂–±–æ–≤–∏—Ö client‚Äë—Ä—è–¥–∫—ñ–≤ (—Ç—ñ–ª—å–∫–∏ –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ/–ø—Ä–µ—Ñ—ñ–∫—Å–æ–≤–∞–Ω–æ–≥–æ —à–ª—è—Ö—É)
- –Ø–∫—â–æ (–ø—ñ—Å–ª—è –∑–Ω—è—Ç—Ç—è –ø—Ä–µ—Ñ—ñ–∫—Å–∞) `body` –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î (case‚Äëinsensitive) –æ–¥–Ω–æ–º—É –∑ –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤:
  - `^dhcp-client on [^ ]+ got IP address [0-9.]+$`
  - –∞–±–æ –º—ñ—Å—Ç–∏—Ç—å –ø—ñ–¥—Ä—è–¥–∫–∏ `dhcp-client on` **—Ç–∞** `got IP address`
- ‚Üí **–ü—Ä–æ–ø—É—Å—Ç–∏—Ç–∏** —Ä—è–¥–æ–∫ –±–µ–∑ –ø–æ–º–∏–ª–∫–∏ (—ñ–Ω–∫—Ä–µ–º–µ–Ω—Ç—É–≤–∞—Ç–∏ –ª—ñ—á–∏–ª—å–Ω–∏–∫ –ø—Ä–æ–ø—É—Å–∫—ñ–≤).

### 3) –ü–∞—Ä—Å–∏–Ω–≥ —Ä—è–¥–∫—ñ–≤ –≤–∏–¥–∞—á—ñ –∞–¥—Ä–µ—Å–∏
- –ü—ñ—Å–ª—è –∑–Ω—è—Ç—Ç—è –ø—Ä–µ—Ñ—ñ–∫—Å–∞ –∑–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ regex (case‚Äëinsensitive) –¥–ª—è DHCP‚Äë–≤–∏–¥–∞—á—ñ:
  ```regex
  ^(?P<dhcpName>[^\s:]+)\s+assigned\s+(?P<ip>[0-9.]+)\s+(?:for|to)\s+(?P<mac>[0-9A-Fa-f:.-]+)(?:\s+(?P<name>.+))?$
  ```
- –ü–æ–ª—è:
  - `ip` ‚Äî IPv4
  - `mac` ‚Äî –Ω–æ—Ä–º–∞–ª—ñ–∑—É–≤–∞—Ç–∏: –∑–∞–º—ñ–Ω–∏—Ç–∏ `-` –Ω–∞ `:`, –ø—Ä–∏–≤–µ—Å—Ç–∏ –¥–æ —Ñ–æ—Ä–º–∞—Ç—É `XX:XX:XX:XX:XX:XX` (–≤–µ—Ä—Ö–Ω—ñ–π —Ä–µ–≥—ñ—Å—Ç—Ä).
  - `name` ‚Äî —è–∫—â–æ –≤—ñ–¥—Å—É—Ç–Ω—î/–ø–æ—Ä–æ–∂–Ω—î/–¥–æ—Ä—ñ–≤–Ω—é—î IP –∞–±–æ MAC ‚Üí `unknown`.

### 4) –°—É–º—ñ—Å–Ω—ñ—Å—Ç—å –∑ CEF
- –¶—è –∑–∞–¥–∞—á–∞ –¥–æ–ø–æ–≤–Ω—é—î –ó–∞–≤–¥–∞–Ω–Ω—è 28. –õ–æ–≥—ñ–∫–∞ —Ç–∞–∫–∞:
  - –Ø–∫—â–æ —Ä—è–¥–æ–∫ –º—ñ—Å—Ç–∏—Ç—å `CEF:` ‚Üí –ø—Ä–∞—Ü—é—î **CEF‚Äë–≥—ñ–ª–∫–∞** (–ó–∞–≤–¥–∞–Ω–Ω—è 28).
  - –Ü–Ω–∞–∫—à–µ ‚Üí ¬´—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞¬ª –≥—ñ–ª–∫–∞, —Ä–æ–∑—à–∏—Ä–µ–Ω–∞ –≤ —Ü—å–æ–º—É –∑–∞–≤–¥–∞–Ω–Ω—ñ –æ–ø—Ü—ñ–π–Ω–∏–º –ø—Ä–µ—Ñ—ñ–∫—Å–æ–º‚Äë—Ç–µ–≥–æ–º.

### 5) –õ–æ–≥—É–≤–∞–Ω–Ω—è
- –ù–µ —Å–ø–∞–º–∏—Ç–∏ –¥–µ—Ç–∞–ª—è–º–∏, –≤–µ—Å—Ç–∏ **–ª–∏—à–µ –ø—ñ–¥—Å—É–º–æ–∫** (—É —Å—Ç–∏–ª—ñ –ó–∞–≤–¥–∞–Ω–Ω—è 21):
  - `üîß –ü—Ä–µ—Ñ—ñ–∫—Å–æ–≤–∞–Ω—ñ DHCP‚Äë—Ä—è–¥–∫–∏: –æ–ø—Ä–∞—Ü—å–æ–≤–∞–Ω–æ=X`
  - `üîß –ü—Ä–æ–ø—É—â–µ–Ω–æ client‚Äë—Ä—è–¥–∫—ñ–≤ (–ø—Ä–µ—Ñ—ñ–∫—Å/—Å—Ç–∞–Ω–¥–∞—Ä—Ç): Y`

---

## üß™ –¢–µ—Å—Ç–∏

### –í—Ö—ñ–¥ ‚Äî —Å–ª—É–∂–±–æ–≤–∏–π client‚Äë—Ä—è–¥–æ–∫ (–º–∞—î –±—É—Ç–∏ –ø—Ä–æ–ø—É—â–µ–Ω–æ)
```
dhcp,info 3CC_: dhcp-client on ether2 got IP address 192.168.1.223
```
**–û—á—ñ–∫—É–≤–∞–Ω–Ω—è:** —Ä—è–¥–æ–∫ **–ø—Ä–æ–ø—É—â–µ–Ω–æ**, —ñ–Ω–∫—Ä–µ–º–µ–Ω—Ç—É—î—Ç—å—Å—è –ª—ñ—á–∏–ª—å–Ω–∏–∫ ¬´client‚Äë—Ä—è–¥–∫—ñ–≤¬ª.

### –í—Ö—ñ–¥ ‚Äî –≤–∏–¥–∞—á–∞ –∞–¥—Ä–µ—Å–∏ —Å–µ—Ä–≤–µ—Ä–æ–º (–º–∞—î –±—É—Ç–∏ —Ä–æ–∑–ø–∞—Ä—Å–µ–Ω–æ)
```
dhcp,info 3CC_: server-guest assigned 192.168.1.108 for FF:EE:DD:CC:BB:AA S24-FE
```
**–û—á—ñ–∫—É–≤–∞–Ω–Ω—è:**  
- `ip = 192.168.1.108`  
- `mac = FF:EE:DD:CC:BB:AA`  
- `name = S24-FE` (–ø—ñ—Å–ª—è –Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—ó)  
- `dhcpName` –Ω–µ –∑–±–µ—Ä—ñ–≥–∞—î–º–æ –æ–∫—Ä–µ–º–æ (–Ω–µ–æ–±–æ–≤‚Äô—è–∑–∫–æ–≤–æ), –∞–ª–µ –ø–∞—Ä—Å –Ω–µ –º–∞—î –∑–∞–ª–µ–∂–∞—Ç–∏ –≤—ñ–¥ –π–æ–≥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è.

### –î–æ–¥–∞—Ç–∫–æ–≤—ñ –ø—Ä–∏–∫–ª–∞–¥–∏
```
dhcp,info myTag: dhcp1 assigned 10.0.0.15 to 00-11-22-33-44-55
dhcp,info VLAN42: LAN_dhcp assigned 192.168.10.25 for 12:34:56:78:9A:BC Redmi-Note
```
**–û—á—ñ–∫—É–≤–∞–Ω–Ω—è:** MAC –Ω–æ—Ä–º–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –¥–æ `00:11:22:33:44:55`, `12:34:56:78:9A:BC`; —ñ–º–µ–Ω–∞ –ø—Ä–æ—á–∏—Ç–∞–Ω—ñ –∫–æ—Ä–µ–∫—Ç–Ω–æ.

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä—ñ—ó –ø—Ä–∏–π–Ω—è—Ç—Ç—è
- [ ] –†—è–¥–∫–∏ –∑ –ø—Ä–µ—Ñ—ñ–∫—Å–æ–º `dhcp,info <TAG>:` –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å—Å—è.
- [ ] –°–ª—É–∂–±–æ–≤—ñ client‚Äë—Ä—è–¥–∫–∏ (`dhcp-client on ‚Ä¶ got IP address ‚Ä¶`) –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—å—Å—è.
- [ ] –†—è–¥–∫–∏ –≤–∏–¥–∞—á—ñ –∞–¥—Ä–µ—Å–∏ (`<dhcpName> assigned <IP> (for|to) <MAC> [<NAME>]`) –ø–∞—Ä—Å—è—Ç—å—Å—è –Ω–µ–∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ `<dhcpName>`.
- [ ] –õ–æ–≥–∏ –º—ñ—Å—Ç—è—Ç—å –ª–∏—à–µ –∫–æ—Ä–æ—Ç–∫—ñ –ø—ñ–¥—Å—É–º–∫–∏, –±–µ–∑ –ø–æ–∫—Ä–æ–∫–æ–≤–æ–≥–æ —Ç—Ä–µ–π—Å–∏–Ω–≥—É.
