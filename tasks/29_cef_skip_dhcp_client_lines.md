# üß© –ó–∞–≤–¥–∞–Ω–Ω—è 29 ‚Äî CEF: –ø—Ä–æ–ø—É—Å–∫–∞—Ç–∏ —Å–ª—É–∂–±–æ–≤—ñ —Ä—è–¥–∫–∏ `dhcp-client on ‚Ä¶ got IP address`

## üéØ –ú–µ—Ç–∞
–ü—ñ–¥ —á–∞—Å –ø–∞—Ä—Å–∏–Ω–≥—É DHCP-–∑–∞–ø–∏—Å—ñ–≤ —É —Ñ–æ—Ä–º–∞—Ç—ñ **CEF** –ø—Ä–æ–ø—É—Å–∫–∞—Ç–∏ (–Ω–µ –æ–±—Ä–æ–±–ª—è—Ç–∏) —Ä—è–¥–∫–∏, –¥–µ –≤ –ø–æ–ª—ñ `msg` –º—ñ—Å—Ç–∏—Ç—å—Å—è —Å–ª—É–∂–±–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∫–ª—ñ—î–Ω—Ç–∞ DHCP –≤–∏–¥—É:
```
dhcp-client on <iface> got IP address <ip>
```
–¶—ñ –ø–æ–¥—ñ—ó –≤—ñ–¥–Ω–æ—Å—è—Ç—å—Å—è –¥–æ –∫–ª—ñ—î–Ω—Ç—Å—å–∫–æ–≥–æ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –∞–¥—Ä–µ—Å–∏ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º —ñ **–Ω–µ —î** –≤–∏–¥–∞—á–µ—é –∞–¥—Ä–µ—Å–∏ —Å–µ—Ä–≤–µ—Ä–æ–º DHCP, —Ç–æ–º—É —ó—Ö –Ω–µ —Å–ª—ñ–¥ –≤–∫–ª—é—á–∞—Ç–∏ –¥–æ –∞–≥—Ä–µ–≥–∞—Ü—ñ–π `interim`/`result`.

---

## üß© –û–ø–∏—Å –ø—Ä–æ–±–ª–µ–º–∏ (–ø—Ä–∏–∫–ª–∞–¥)
```
–ù–µ–º–æ–∂–ª–∏–≤–æ —Ä–æ–∑–ø–∞—Ä—Å–∏—Ç–∏ —Ä—è–¥–æ–∫ payloadAsUTF: 2025-11-08T03:12:43.611+0200 1MB CEF:0|MikroTik|RB2011UAS|7.19.4 (stable)|16|dhcp,info|Low|dvcchost=1MB dvc=10.10.10.225 msg=dhcp-client on ether1 got IP address 192.168.1.22
```
–ó–∞–º—ñ—Å—Ç—å –ø–æ–º–∏–ª–∫–∏/—Å–ø—Ä–æ–± —Ä–æ–∑–ø–∞—Ä—Å–∏—Ç–∏ —è–∫ –≤–∏–¥–∞—á—É –∞–¥—Ä–µ—Å–∏, —Ç–∞–∫–∏–π —Ä—è–¥–æ–∫ **–ø–æ—Ç—Ä—ñ–±–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç–∏**.

---

## ‚öôÔ∏è –ó–∞–≤–¥–∞–Ω–Ω—è

### 1) –î—ñ—î –ª–∏—à–µ –¥–ª—è CEF
- –ó–∞—Å—Ç–æ—Å–æ–≤—É–≤–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª–æ **–ª–∏—à–µ —è–∫—â–æ** `payloadAsUTF` –≤–∏–∑–Ω–∞—á–µ–Ω–æ —è–∫ CEF (—Ä—è–¥–æ–∫ –º—ñ—Å—Ç–∏—Ç—å `CEF:`).
- –í–∏–¥—ñ–ª–∏—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è `msg` (—á–µ—Ä–µ–∑ –ø–∞—Ä—Å–∏–Ω–≥ `k=v` –ø–∞—Ä–∏).

### 2) –£–º–æ–≤–∞ –ø—Ä–æ–ø—É—Å–∫—É
- –Ø–∫—â–æ `msg` (case-insensitive) –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —à–∞–±–ª–æ–Ω—É:
  - `^dhcp-client on [^ ]+ got IP address [0-9.]+$`
- –∞–±–æ –º—ñ—Å—Ç–∏—Ç—å –ø—ñ–¥—Ä—è–¥–æ–∫:
  - `dhcp-client on` **—Ç–∞** `got IP address`
- ‚Üí **–ø—Ä–æ–ø—É—Å—Ç–∏—Ç–∏** —Ä—è–¥–æ–∫: –Ω–µ —Ñ–æ—Ä–º—É–≤–∞—Ç–∏ –∑–∞–ø–∏—Å `ip/mac/name` —ñ –Ω–µ –≤–∫–ª—é—á–∞—Ç–∏ –¥–æ –≤–∏—Ö—ñ–¥–Ω–∏—Ö CSV.

### 3) –õ–æ–≥—É–≤–∞–Ω–Ω—è (—Å—Ç–∏—Å–ª–æ, —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é)
- –ù–µ –≤–∏–≤–æ–¥–∏—Ç–∏ –¥–µ—Ç–∞–ª—å–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Ä—è–¥–∫–∞.
- –ü—ñ–¥—Ä–∞—Ö—É–≤–∞—Ç–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–æ–ø—É—â–µ–Ω–∏—Ö CEF‚Äë—Ä—è–¥–∫—ñ–≤ —Ç–∞–∫–æ–≥–æ —Ç–∏–ø—É —ñ –ø—ñ—Å–ª—è –æ–±—Ä–æ–±–∫–∏ –ø–æ–∫–∞–∑–∞—Ç–∏ –∫–æ—Ä–æ—Ç–∫–∏–π –ø—ñ–¥—Å—É–º–æ–∫, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥:
```
üîß CEF: –ø—Ä–æ–ø—É—â–µ–Ω–æ —Å–ª—É–∂–±–æ–≤–∏—Ö —Ä—è–¥–∫—ñ–≤ dhcp-client: 7
```
(–£–∑–≥–æ–¥–∂–µ–Ω–æ –∑—ñ —Å—Ç–∏–ª–µ–º –ó–∞–≤–¥–∞–Ω–Ω—è 21 ‚Äî –ª–∏—à–µ –ø—ñ–¥—Å—É–º–æ–∫.)

### 4) –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç –ø—Ä–∞–≤–∏–ª
- –î–ª—è CEF —Å–ø–æ—á–∞—Ç–∫—É –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —É–º–æ–≤—É –ø—Ä–æ–ø—É—Å–∫—É (`dhcp-client on ‚Ä¶ got IP address`), —ñ **–ª–∏—à–µ —è–∫—â–æ –Ω–µ —Å–ø—ñ–≤–ø–∞–ª–æ**, –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –ø–æ–¥–∞–ª—å—à–∏–π –ø–∞—Ä—Å–∏–Ω–≥ `msg` —è–∫ –≤–∏–¥–∞—á—É IP —Å–µ—Ä–≤–µ—Ä–æ–º:
  - `dhcp,info <dhcpName> assigned <IP> (for|to) <MAC> [<NAME>]`

---

## üß™ –¢–µ—Å—Ç–∏

**–í—Ö—ñ–¥ (CEF, —Å–ª—É–∂–±–æ–≤–∏–π —Ä—è–¥–æ–∫ ‚Äî –º–∞—î –±—É—Ç–∏ –ø—Ä–æ–ø—É—â–µ–Ω–æ):**
```
2025-11-08T03:12:43.611+0200 1MB CEF:0|MikroTik|RB2011UAS|7.19.4 (stable)|16|dhcp,info|Low|dvcchost=1MB dvc=10.10.10.225 msg=dhcp-client on ether1 got IP address 192.168.1.22
```
**–û—á—ñ–∫—É–≤–∞–Ω–Ω—è:** —Ä—è–¥–æ–∫ **–Ω–µ** –ø–æ—Ç—Ä–∞–ø–ª—è—î –¥–æ `data/interim/dhcp.csv` / `data/result/dhcp-*.csv`, –ª—ñ—á–∏–ª—å–Ω–∏–∫ –ø—Ä–æ–ø—É—â–µ–Ω–∏—Ö CEF‚Äë—Ä—è–¥–∫—ñ–≤ –∑–±—ñ–ª—å—à—É—î—Ç—å—Å—è –Ω–∞ 1.

**–í—Ö—ñ–¥ (CEF, –∫–æ—Ä–µ–∫—Ç–Ω–∏–π —Ä—è–¥–æ–∫ –≤–∏–¥–∞—á—ñ –∞–¥—Ä–µ—Å–∏ ‚Äî –º–∞—î –±—É—Ç–∏ —Ä–æ–∑–ø–∞—Ä—Å–µ–Ω–æ):**
```
2025-11-01T01:10:54.868+0200 1MB CEF:0|MikroTik|RB2011UAS|7.19.4 (stable)|16|dhcp,info|Low|dvchost=1MB dvc=10.10.10.225 msg=dhcp1 assigned 192.168.1.14 for AA:44:33:00:77:CC POCO
```
**–û—á—ñ–∫—É–≤–∞–Ω–Ω—è:** —É—Å–ø—ñ—à–Ω–∏–π –ø–∞—Ä—Å–∏–Ω–≥ (`ip`, `mac`, `name`) —ñ –≤–∫–ª—é—á–µ–Ω–Ω—è –≤ –ø–æ–¥–∞–ª—å—à—É –æ–±—Ä–æ–±–∫—É.

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä—ñ—ó –ø—Ä–∏–π–Ω—è—Ç—Ç—è
- [ ] –†—è–¥–∫–∏ CEF —ñ–∑ `msg` —Ç–∏–ø—É `dhcp-client on ‚Ä¶ got IP address ‚Ä¶` –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—å—Å—è –±–µ–∑ –ø–æ–º–∏–ª–æ–∫.
- [ ] –î–ª—è —Ç–∞–∫–∏—Ö —Ä—è–¥–∫—ñ–≤ –Ω–µ —Ñ–æ—Ä–º—É—î—Ç—å—Å—è –∂–æ–¥–Ω–æ–≥–æ –∑–∞–ø–∏—Å—É —É `interim`/`result` CSV.
- [ ] –í–∏–≤–æ–¥–∏—Ç—å—Å—è –ª–∏—à–µ **–∫–æ—Ä–æ—Ç–∫–∏–π –ø—ñ–¥—Å—É–º–æ–∫** –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –ø—Ä–æ–ø—É—â–µ–Ω–∏—Ö —Å–ª—É–∂–±–æ–≤–∏—Ö —Ä—è–¥–∫—ñ–≤ CEF.
- [ ] –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ CEF‚Äë—Ä—è–¥–∫–∏ –∑ –≤–∏–¥–∞—á–µ—é –∞–¥—Ä–µ—Å–∏ (`‚Ä¶ assigned <IP> (for|to) <MAC> ‚Ä¶`) –æ–±—Ä–æ–±–ª—è—é—Ç—å—Å—è —è–∫ —ñ —Ä–∞–Ω—ñ—à–µ.
