# üß© –ó–∞–≤–¥–∞–Ω–Ω—è 03 ‚Äî –ê–≥—Ä–µ–≥–∞—Ü—ñ—è DHCP-–ª–æ–≥—ñ–≤ —É `data/interim/dhcp.csv`

## üéØ –ú–µ—Ç–∞
–ó—á–∏—Ç–∞—Ç–∏ –≤—Å—ñ —Ñ–∞–π–ª–∏ `data/raw/dhcp/*.csv` (—ñ–≥–Ω–æ—Ä—É—é—á–∏ `*.example.csv`) –∑ —Ñ–æ—Ä–º–∞—Ç–∞–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤ —è–∫ —É –ø—Ä–∏–∫–ª–∞–¥—ñ –Ω–∏–∂—á–µ, –∑–≥—Ä—É–ø—É–≤–∞—Ç–∏ –∑–∞–ø–∏—Å–∏ –∑–∞ MAC‚Äë–∞–¥—Ä–µ—Å–æ—é —Ç–∞ —Å—Ñ–æ—Ä–º—É–≤–∞—Ç–∏ –∞–≥—Ä–µ–≥–æ–≤–∞–Ω–∏–π —Ñ–∞–π–ª `data/interim/dhcp.csv` –∑ –ø–æ–ª—è–º–∏:
```
source,ip,mac,name,firstDate,lastDate,firstDateEpoch,lastDateEpoch,count,randomized,dateList
```

–ü—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ–≥–æ –∑–∞–ø–∏—Å—É –≤–∏–≤–µ—Å—Ç–∏ –≤ –∫–æ–Ω—Å–æ–ª—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑ –∫—ñ–ª—å–∫—ñ—Å—Ç—é —Ä—è–¥–∫—ñ–≤, –∑–∞–ø–∏—Å–∞–Ω–∏—Ö –¥–æ `data/interim/dhcp.csv` (–±–µ–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞).

---

## üì• –í—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ (–ø—Ä–∏–∫–ª–∞–¥ —Ñ–æ—Ä–º–∞—Ç—ñ–≤ `data/raw/dhcp/*.csv`)
### –í–∞—Ä—ñ–∞–Ω—Ç A (–º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥)
```
source,ip,mac,name,firstDate,lastDate,count,randomized
10.0.0.10,192.168.0.10,AA:BB:CC:DD:EE:FF,Device1,1754562443848,1754562532771,1,true
```

### –í–∞—Ä—ñ–∞–Ω—Ç B (–æ—Å–Ω–æ–≤–Ω–∏–π –¥–ª—è —Ü—å–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è)
```
logSourceIdentifier,sourcMACAddress,payloadAsUTF,deviceTime
"10.0.0.10","EE:3C:E7:DA:8E:B4","dhcp,info defconf assigned 192.168.1.60 for EE:3C:E7:DA:8E:B4","1755006684895"
"10.0.0.10","86:6C:43:84:70:2F","dhcp,info defconf assigned 192.168.1.69 for 86:6C:43:84:70:2F Xiaomi-14T-Pro","1755006240482"
```

> –ü–†–ò–ú–Ü–¢–ö–ê: –£ –ø–æ–ª—ñ `payloadAsUTF` IP —ñ (–æ–ø—Ü—ñ–π–Ω–æ) —ñ–º º—è –ø—Ä–∏—Å—Ç—Ä–æ—é –∑ º—è–≤–ª—è—é—Ç—å—Å—è –ø—ñ—Å–ª—è MAC:  
> ‚Ä¢ –ø—Ä–∏–∫–ª–∞–¥ **–±–µ–∑ —ñ–º–µ–Ω—ñ**: `... assigned 192.168.1.60 for EE:3C:E7:DA:8E:B4`  
> ‚Ä¢ –ø—Ä–∏–∫–ª–∞–¥ **–∑ —ñ–º–µ–Ω–µ–º**: `... assigned 192.168.1.69 for 86:6C:43:84:70:2F Xiaomi-14T-Pro`

---

## üßæ –ü—Ä–∞–≤–∏–ª–∞ –º–∞–ø—ñ–Ω–≥—É —Ç–∞ –∞–≥—Ä–µ–≥–∞—Ü—ñ—ó
- `mac` = `sourcMACAddress`. **MAC —É –≤–∏—Ö—ñ–¥–Ω–æ–º—É —Ñ–∞–π–ª—ñ –º–∞—î –±—É—Ç–∏ —É–Ω—ñ–∫–∞–ª—å–Ω–∏–º** (–æ–¥–∏–Ω —Ä—è–¥–æ–∫ –Ω–∞ MAC).
- `source` = –æ—Å—Ç–∞–Ω–Ω—î (–∑–∞ —á–∞—Å–æ–º) –∑–Ω–∞—á–µ–Ω–Ω—è `logSourceIdentifier` –¥–ª—è —Ü—å–æ–≥–æ MAC (–±–µ—Ä–µ–º–æ –∑–∞–ø–∏—Å –∑ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–º `deviceTime`).
- `ip` = IP‚Äë–∞–¥—Ä–µ—Å–∞, –≤–∏—Ç—è–≥–Ω—É—Ç–∞ –∑ `payloadAsUTF`, **–æ—Å—Ç–∞–Ω–Ω—è –∑–∞ —á–∞—Å–æ–º** (–∑ –∑–∞–ø–∏—Å—É –∑ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–º `deviceTime`).
- `name` = —ñ–º‚Äô—è –∑ `payloadAsUTF` –ø—ñ—Å–ª—è MAC (—è–∫—â–æ –≤—ñ–¥—Å—É—Ç–Ω—î ‚Äî –∑–∞–ø–∏—Å–∞—Ç–∏ `unknown`).  
  –ü—Ä–∏–∫–ª–∞–¥ –≤—ñ–¥—Å—É—Ç–Ω–æ—Å—Ç—ñ: `... for EE:3C:E7:DA:8E:B4` ‚Üí `name = unknown`.
- `firstDateEpoch` = **–º—ñ–Ω—ñ–º–∞–ª—å–Ω–µ** `deviceTime` (epochtime —É –º—ñ–ª—ñ—Å–µ–∫—É–Ω–¥–∞—Ö –∞–±–æ —Å–µ–∫—É–Ω–¥–∞—Ö ‚Äî –Ω–µ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –æ–¥–∏–Ω–∏—Ü—ñ, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —è–∫ —î —É –≤—Ö—ñ–¥–Ω–∏—Ö —Ñ–∞–π–ª–∞—Ö).  
- `lastDateEpoch` = **–º–∞–∫—Å–∏–º–∞–ª—å–Ω–µ** `deviceTime`.
- `firstDate` = `firstDateEpoch` —É —Ñ–æ—Ä–º–∞—Ç—ñ `YYYY.MM.DD HH:MM` (—Ç–∞–π–º–∑–æ–Ω–∞ `Europe/Kyiv`).  
- `lastDate`  = `lastDateEpoch` —É —Ñ–æ—Ä–º–∞—Ç—ñ `YYYY.MM.DD HH:MM` (—Ç–∞–π–º–∑–æ–Ω–∞ `Europe/Kyiv`).
- `count` = —Å–∫—ñ–ª—å–∫–∏ —Ä–∞–∑—ñ–≤ MAC –∑—É—Å—Ç—Ä—ñ—á–∞—î—Ç—å—Å—è –∑–∞–≥–∞–ª–æ–º —É –≤—Å—ñ—Ö –≤—Ö—ñ–¥–Ω–∏—Ö —Ñ–∞–π–ª–∞—Ö.
- `randomized` = `true`, —è–∫—â–æ MAC **—Ä–∞–Ω–¥–æ–º–Ω–∏–π**, —ñ `false`, —è–∫—â–æ **–¥—ñ–π—Å–Ω–∏–π**.  
  **–ö—Ä–∏—Ç–µ—Ä—ñ–π**: MAC –≤–≤–∞–∂–∞—î—Ç—å—Å—è —Ä–∞–Ω–¥–æ–º–Ω–∏–º, —è–∫—â–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π **–ª–æ–∫–∞–ª—å–Ω–æ –∫–µ—Ä–æ–≤–∞–Ω–∏–π** –±—ñ—Ç —É –ø–µ—Ä—à–æ–º—É –æ–∫—Ç–µ—Ç—ñ (U/L bit = 1). –¢–æ–±—Ç–æ, —è–∫—â–æ (–ø–µ—Ä—à–∏–π –±–∞–π—Ç & `0x02`) != 0 ‚Üí `randomized = true`.
- `dateList` = —É—Å—ñ —á–∞—Å–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–ª—è —Ü—å–æ–≥–æ MAC —Å–ø–∏—Å–∫–æ–º —É —Ñ–æ—Ä–º–∞—Ç—ñ epochtime, –≤—ñ–¥—Å–æ—Ä—Ç–æ–≤–∞–Ω—ñ –∑–∞ –∑—Ä–æ—Å—Ç–∞–Ω–Ω—è–º, —á–µ—Ä–µ–∑ `, ` (–∫–æ–º–∞ + –ø—Ä–æ–±—ñ–ª).

> –Ø–∫—â–æ –∑—É—Å—Ç—Ä—ñ—á–∞—é—Ç—å—Å—è –∑–∞–ø–∏—Å–∏ –¥–ª—è –æ–¥–Ω–æ–≥–æ MAC –∑ —Ä—ñ–∑–Ω–∏–º–∏ `logSourceIdentifier`, —Ç–æ —É –ø—ñ–¥—Å—É–º–æ–∫ —É –ø–æ–ª—ñ `source` –ø–æ—Ç—Ä–∞–ø–ª—è—î **—Å–∞–º–µ –∑–Ω–∞—á–µ–Ω–Ω—è –∑ –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –∑–∞ —á–∞—Å–æ–º** –∑–∞–ø–∏—Å—É (–∑–∞ `deviceTime`).

---

## üß† –¢–µ—Ö–Ω—ñ—á–Ω—ñ –≤–∏–º–æ–≥–∏
- –ú–æ–≤–∞: **Python 3.10+**. –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫—É: `scripts/psh.py`.
- –î–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó `data/raw/dhcp/` —Ç–∞ `data/interim/` ‚Äî –≤—ñ–¥–Ω–æ—Å–Ω–æ –∫–æ—Ä–µ–Ω—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é. –ó–∞ –ø–æ—Ç—Ä–µ–±–∏ ‚Äî —Å—Ç–≤–æ—Ä–∏—Ç–∏ `data/interim/`.
- –Ü–≥–Ω–æ—Ä—É–≤–∞—Ç–∏ –≤—Å—ñ —Ñ–∞–π–ª–∏, —â–æ –∑–∞–∫—ñ–Ω—á—É—é—Ç—å—Å—è –Ω–∞ `.example.csv`.
- –ö–æ–¥ –ø–æ–≤–∏–Ω–µ–Ω:
  - –∫–æ—Ä–µ–∫—Ç–Ω–æ —á–∏—Ç–∞—Ç–∏ UTF‚Äë8/UTF‚Äë8‚ÄëSIG,
  - –∞–≤—Ç–æ‚Äë–≤–∏–∑–Ω–∞—á–∞—Ç–∏ —Ä–æ–∑–¥—ñ–ª—å–Ω–∏–∫ —á–µ—Ä–µ–∑ `csv.Sniffer` –∑ fallback –Ω–∞ `,`,
  - –æ–±—Ä–æ–±–ª—è—Ç–∏ –ø–æ—Ä–æ–∂–Ω—ñ —Ñ–∞–π–ª–∏ —Ç–∞ –≤—ñ–¥—Å—É—Ç–Ω—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∏ (–ø–æ–º–∏–ª–∫–∞ ‚Üí –∑—É–ø–∏–Ω–∫–∞ –æ–±—Ä–æ–±–∫–∏),
  - –±—É—Ç–∏ —Å—Ç—ñ–π–∫–∏–º –¥–æ –ø—Ä–æ–±—ñ–ª—ñ–≤ –Ω–∞–≤–∫–æ–ª–æ –Ω–∞–∑–≤ –∫–æ–ª–æ–Ω–æ–∫ (strip).
- –ü—ñ–¥ —á–∞—Å –∑—á–∏—Ç—É–≤–∞–Ω–Ω—è `deviceTime`:
  - –ø—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ —è–∫ **–º—ñ–ª—ñ—Å–µ–∫—É–Ω–¥–∏**, —Ç–∞–∫ —ñ **—Å–µ–∫—É–Ω–¥–∏** (—è–∫—â–æ –∑–Ω–∞—á–µ–Ω–Ω—è –≤–∏–≥–ª—è–¥–∞—î —è–∫ 13‚Äë–∑–Ω–∞—á–Ω–µ ‚Üí —Ü–µ –º—ñ–ª—ñ—Å–µ–∫—É–Ω–¥–∏; 10‚Äë–∑–Ω–∞—á–Ω–µ ‚Üí —Å–µ–∫—É–Ω–¥–∏; –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ **–æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω—ñ** –∑–Ω–∞—á–µ–Ω–Ω—è —É `dateList` —Ç–∞ `firstDateEpoch/lastDateEpoch`, –∞–ª–µ –¥–ª—è `firstDate/lastDate` –∫–æ–Ω–≤–µ—Ä—Ç—É–≤–∞—Ç–∏ –≤ datetime).
- –í–∏—Ö—ñ–¥–Ω–∏–π CSV –º–∞—î –º—ñ—Å—Ç–∏—Ç–∏ —Ä—ñ–≤–Ω–æ —Ç–∞–∫—ñ –∫–æ–ª–æ–Ω–∫–∏ —Ç–∞ –ø–æ—Ä—è–¥–æ–∫:
  ```
  source,ip,mac,name,firstDate,lastDate,firstDateEpoch,lastDateEpoch,count,randomized,dateList
  ```

---

## üîé –ü–∞—Ä—Å–∏–Ω–≥ `payloadAsUTF`
- –í–∏—Ç—è–≥–Ω—É—Ç–∏ IP: —à–∞–±–ª–æ–Ω `assigned\s+(?P<ip>\d+\.\d+\.\d+\.\d+)\s+for`.
- –í–∏—Ç—è–≥–Ω—É—Ç–∏ MAC: —à–∞–±–ª–æ–Ω `for\s+(?P<mac>[0-9A-Fa-f]{2}(?::[0-9A-Fa-f]{2}){5})`.
- –Ü–º‚Äô—è (–Ω–µ–æ–±–æ–≤ º—è–∑–∫–æ–≤–µ): **—É—Å–µ –ø—ñ—Å–ª—è MAC** –¥–æ –∫—ñ–Ω—Ü—è —Ä—è–¥–∫–∞ (trim). –Ø–∫—â–æ –ø–æ—Ä–æ–∂–Ω—å–æ ‚Äî `unknown`.

---

## üì§ –í–∏–≤—ñ–¥ —É –∫–æ–Ω—Å–æ–ª—å
–ü—ñ—Å–ª—è –∑–∞–ø–∏—Å—É `data/interim/dhcp.csv` –≤–∏–≤–µ—Å—Ç–∏:
```
‚úÖ –ó–∞–ø–∏—Å–∞–Ω–æ —Ä—è–¥–∫—ñ–≤ –¥–æ data/interim/dhcp.csv: <N>
```

---

## üß™ –ü—Ä–∏–∫–ª–∞–¥ –æ—á—ñ–∫—É–≤–∞–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É (—Ä—è–¥–æ–∫)
```
source,ip,mac,name,firstDate,lastDate,firstDateEpoch,lastDateEpoch,count,randomized,dateList
10.0.0.10,192.168.0.10,AA:BB:CC:DD:EE:FF,Device1,2025.08.07 10:27,2025.08.08 15:22,1754562443848,1754666536771,1,false,"1754562443848, 1754655536771, 1754666536771"
```

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä—ñ—ó –ø—Ä–∏–π–Ω—è—Ç—Ç—è
- [ ] –ö–æ—Ä–µ–∫—Ç–Ω–æ –∑—á–∏—Ç—É—é—Ç—å—Å—è –≤—Å—ñ –≤—Ö—ñ–¥–Ω—ñ CSV –∑ `data/raw/dhcp/`, —ñ–≥–Ω–æ—Ä—É—é—Ç—å—Å—è `*.example.csv`.
- [ ] –ì—Ä—É–ø—É–≤–∞–Ω–Ω—è –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –∑–∞ MAC; —É –≤–∏—Ö—ñ–¥–Ω–æ–º—É —Ñ–∞–π–ª—ñ –∫–æ–∂–µ–Ω MAC —Ä—ñ–≤–Ω–æ –æ–¥–∏–Ω —Ä–∞–∑.
- [ ] `source` —Ç–∞ `ip` –±–µ—Ä—É—Ç—å—Å—è –∑ **–æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –∑–∞ —á–∞—Å–æ–º** –∑–∞–ø–∏—Å—É (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π `deviceTime`).
- [ ] `name` –∫–æ—Ä–µ–∫—Ç–Ω–æ –ø–∞—Ä—Å–∏—Ç—å—Å—è –∑ `payloadAsUTF`; —è–∫—â–æ —ñ–º–µ–Ω—ñ –Ω–µ–º–∞—î ‚Äî `unknown`.
- [ ] `firstDateEpoch`/`lastDateEpoch` –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –º—ñ–Ω/–º–∞–∫—Å `deviceTime`; `firstDate`/`lastDate` ‚Äî —É —Ñ–æ—Ä–º–∞—Ç—ñ `YYYY.MM.DD HH:MM` (Europe/Kyiv).
- [ ] `randomized` –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è –∑–∞ U/L‚Äë–±—ñ—Ç–æ–º –ø–µ—Ä—à–æ–≥–æ –æ–∫—Ç–µ—Ç—É MAC.
- [ ] `dateList` –º—ñ—Å—Ç–∏—Ç—å **—É—Å—ñ** –∑–Ω–∞—á–µ–Ω–Ω—è `deviceTime` –¥–ª—è MAC, –≤—ñ–¥—Å–æ—Ä—Ç–æ–≤–∞–Ω–æ, —É –≤–∏—Ö—ñ–¥–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ.
- [ ] –í –∫—ñ–Ω–µ—Ü—å —Ä–æ–±–æ—Ç–∏ –≤–∏–≤–æ–¥–∏—Ç—å—Å—è –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–ø–∏—Å–∞–Ω–∏—Ö —Ä—è–¥–∫—ñ–≤.
