# üß© –ó–∞–≤–¥–∞–Ω–Ω—è 36 ‚Äî –£–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∏–π –ø–∞—Ä—Å–µ—Ä `payloadAsUTF` –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏—Ö DHCP —Ä—è–¥–∫—ñ–≤ (–¥–æ–≤—ñ–ª—å–Ω–∞ –Ω–∞–∑–≤–∞ DHCP —Å–µ—Ä–≤–µ—Ä–∞)

## üéØ –ú–µ—Ç–∞
–í–∏–ø—Ä–∞–≤–∏—Ç–∏ —Ç–∞ —É–Ω—ñ—Ñ—ñ–∫—É–≤–∞—Ç–∏ –ø–∞—Ä—Å–µ—Ä `payloadAsUTF` –¥–ª—è **—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ** —Ñ–æ—Ä–º–∞—Ç—É MikroTik DHCP –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å, —â–æ–± –≤—ñ–Ω –∫–æ—Ä–µ–∫—Ç–Ω–æ –ø—Ä–∞—Ü—é–≤–∞–≤ –∫–æ–ª–∏ –º—ñ–∂ `dhcp,info` —Ç–∞ —Å–ª–æ–≤–æ–º `assigned` –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è **–¥–æ–≤—ñ–ª—å–Ω–∞ –Ω–∞–∑–≤–∞ / –Ω–∞–±—ñ—Ä —Å–ª—ñ–≤** (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥ ¬´–≤–µ—Ä—Ö–Ω—ñ–π —Ä—è–¥ DHCP¬ª, ¬´Home DHCP¬ª, ¬´–Ω–∏–∂–Ω—ñ–π —Ä—è–¥ DHCP¬ª —Ç–æ—â–æ).

---

## üß© –ü—Ä–∏–∫–ª–∞–¥–∏, —è–∫—ñ –º–∞—é—Ç—å –ø–∞—Ä—Å–∏—Ç–∏—Å—è

### –ë–∞–∑–æ–≤–∏–π —Ñ–æ—Ä–º–∞—Ç (–≤–∂–µ –ø—ñ–¥—Ç—Ä–∏–º–∞–Ω–∏–π)
```
dhcp,info dhcp1 assigned 192.168.11.57 for C4:22:FC:44:47:81
```

### –ù–æ–≤—ñ –≤–∞—Ä—ñ–∞–Ω—Ç–∏ (–ø–æ—Ç—Ä—ñ–±–Ω–æ –ø—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏)
```
dhcp,info –≤–µ—Ä—Ö–Ω—ñ–π —Ä—è–¥ DHCP assigned 192.168.55.159 for EE:33:52:11:49:91
dhcp,info –Ω–∏–∂–Ω—ñ–π —Ä—è–¥ DHCP assigned 192.168.99.240 for 00:22:44:91:95:52 Ariba
dhcp,info Home DHCP assigned 192.168.10.11 for 7E:44:02:44:6D:44
```

---

## ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞
–ü–æ—Ç–æ—á–Ω–∏–π regex/–ª–æ–≥—ñ–∫–∞ –æ—á—ñ–∫—É—î, —â–æ –ø—ñ—Å–ª—è `dhcp,info` –±—É–¥–µ **–æ–¥–Ω–µ —Å–ª–æ–≤–æ** (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥ `dhcp1` –∞–±–æ `defconf`), –∞ –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—ñ —Ç–∞–º –º–æ–∂–µ –±—É—Ç–∏ **–∫—ñ–ª—å–∫–∞ —Å–ª—ñ–≤** —Ç–∞ –Ω–∞–≤—ñ—Ç—å –∫–∏—Ä–∏–ª–∏—Ü—è.

---

## ‚úÖ –í–∏–º–æ–≥–∏ –¥–æ –Ω–æ–≤–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞ (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ –≥—ñ–ª–∫–∞)

### 1) –£–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–µ –ø—Ä–∞–≤–∏–ª–æ
–î–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏—Ö DHCP —Ä—è–¥–∫—ñ–≤ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ —à–∞–±–ª–æ–Ω:
- —Ä—è–¥–æ–∫ –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ `dhcp,info`
- –¥–∞–ª—ñ –π–¥–µ **–¥–æ–≤—ñ–ª—å–Ω–∏–π —Ç–µ–∫—Å—Ç** (–Ω–∞–∑–≤–∞ DHCP —Å–µ—Ä–≤–µ—Ä–∞/–ø—É–ª—É/–ª–µ–π–±–ª) –¥–æ —Å–ª–æ–≤–∞ `assigned`
- –ø–æ—Ç—ñ–º:
  - IP –∞–¥—Ä–µ—Å–∞
  - `for` –∞–±–æ `to`
  - MAC –∞–¥—Ä–µ—Å–∞
  - –æ–ø—Ü—ñ–π–Ω–æ `name`

### 2) –í–∏—Ç—è–≥–Ω—É—Ç–∏ –ø–æ–ª—è
- `ip` ‚Äî IPv4 –ø—ñ—Å–ª—è `assigned`
- `mac` ‚Äî MAC –ø—ñ—Å–ª—è `for|to`
- `name` ‚Äî –≤—Å–µ —â–æ –ø—ñ—Å–ª—è MAC (—è–∫—â–æ —î), —ñ–Ω–∞–∫—à–µ `unknown`

### 3) –ù–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è
- MAC –ø—Ä–∏–≤–µ—Å—Ç–∏ –¥–æ `XX:XX:XX:XX:XX:XX`
  - –ø—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ –≤—Ö—ñ–¥–Ω—ñ `:` —Ç–∞ `-`
- `name`:
  - `strip()`
  - —è–∫—â–æ –ø–æ—Ä–æ–∂–Ω—ñ–π ‚Üí `unknown`
  - —è–∫—â–æ –≤–∏–≥–ª—è–¥–∞—î —è–∫ IP –∞–±–æ MAC ‚Üí `unknown`

### 4) –°—É–º—ñ—Å–Ω—ñ—Å—Ç—å
- –ù–µ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ CEF, dnsmasq, UniFi WiFi, —Ç–∞ —ñ–Ω—à—ñ –æ–∫—Ä–µ–º—ñ –≥—ñ–ª–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥—É.
- –¶—è –∑–∞–¥–∞—á–∞ —Å—Ç–æ—Å—É—î—Ç—å—Å—è –ª–∏—à–µ **—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ—ó** –≥—ñ–ª–∫–∏, –¥–µ `payloadAsUTF` –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ `dhcp,info` (–≤–∫–ª—é—á–Ω–æ –∑ –ø—Ä–µ—Ñ—ñ–∫—Å–æ–≤–∞–Ω–∏–º —Ñ–æ—Ä–º–∞—Ç–æ–º –∑ –ó–∞–≤–¥–∞–Ω–Ω—è 30 –ø—ñ—Å–ª—è –∑–Ω—è—Ç—Ç—è –ø—Ä–µ—Ñ—ñ–∫—Å–∞).

---

## üîé –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è –¥–ª—è regex
Regex –º–∞—î –¥–æ–∑–≤–æ–ª—è—Ç–∏ **–±—É–¥—å-—è–∫–∏–π —Ç–µ–∫—Å—Ç** –º—ñ–∂ `dhcp,info` —Ç–∞ `assigned`, –≤–∫–ª—é—á–Ω–æ –∑ –ø—Ä–æ–±—ñ–ª–∞–º–∏ —ñ –∫–∏—Ä–∏–ª–∏—Ü–µ—é. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –∫–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–æ:
- `dhcp,info` + –ø—Ä–æ–±—ñ–ª–∏
- **–±—É–¥—å-—â–æ** –¥–æ `assigned` (–º—ñ–Ω—ñ–º–∞–ª—å–Ω–æ –∂–∞–¥—ñ–±–Ω–æ)
- `assigned` + –ø—Ä–æ–±—ñ–ª–∏
- `IP` + –ø—Ä–æ–±—ñ–ª–∏
- `for|to` + –ø—Ä–æ–±—ñ–ª–∏
- `MAC` + –æ–ø—Ü—ñ–π–Ω–æ `name`

(–ö–æ–Ω–∫—Ä–µ—Ç–Ω—É —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—é regex –æ–±—Ä–∞—Ç–∏ –≤ –∫–æ–¥—ñ, –∞–ª–µ –æ–±–æ–≤‚Äô—è–∑–∫–æ–≤–æ –ø—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ multi-word –Ω–∞–∑–≤–∏.)

---

## üß™ –¢–µ—Å—Ç–∏

### 1) –ë–µ–∑ —ñ–º–µ–Ω—ñ
–í—Ö—ñ–¥:
```
dhcp,info –≤–µ—Ä—Ö–Ω—ñ–π —Ä—è–¥ DHCP assigned 192.168.55.159 for EE:33:52:11:49:91
```
–û—á—ñ–∫—É–≤–∞–Ω–Ω—è:
- `ip = 192.168.55.159`
- `mac = EE:33:52:11:49:91`
- `name = unknown`

### 2) –ó —ñ–º–µ–Ω–µ–º
–í—Ö—ñ–¥:
```
dhcp,info –Ω–∏–∂–Ω—ñ–π —Ä—è–¥ DHCP assigned 192.168.99.240 for 00:22:44:91:95:52 Ariba
```
–û—á—ñ–∫—É–≤–∞–Ω–Ω—è:
- `ip = 192.168.99.240`
- `mac = 00:22:44:91:95:52`
- `name = Ariba`

### 3) –ë–∞–∑–æ–≤–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç
–í—Ö—ñ–¥:
```
dhcp,info dhcp1 assigned 192.168.11.57 for C4:22:FC:44:47:81
```
–û—á—ñ–∫—É–≤–∞–Ω–Ω—è:
- `ip = 192.168.11.57`
- `mac = C4:22:FC:44:47:81`
- `name = unknown`

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä—ñ—ó –ø—Ä–∏–π–Ω—è—Ç—Ç—è
- [ ] –ü–∞—Ä—Å–µ—Ä –∫–æ—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–æ–±–ª—è—î multi-word –Ω–∞–∑–≤–∏ –º—ñ–∂ `dhcp,info` —Ç–∞ `assigned` (–≤–∫–ª—é—á–Ω–æ –∑ –∫–∏—Ä–∏–ª–∏—Ü–µ—é).
- [ ] –ù–µ –≤–∏–Ω–∏–∫–∞—î –ø–æ–º–∏–ª–æ–∫ –ø–∞—Ä—Å–∏–Ω–≥—É –Ω–∞ –Ω–∞–≤–µ–¥–µ–Ω–∏—Ö –ø—Ä–∏–∫–ª–∞–¥–∞—Ö.
- [ ] –ù–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è MAC —ñ `name` –ø—Ä–∞—Ü—é—î –∑–∞ –ø—Ä–∞–≤–∏–ª–∞–º–∏ –≤–∏—â–µ.
- [ ] –Ü–Ω—à—ñ —Ñ–æ—Ä–º–∞—Ç–∏ (CEF/dnsmasq/UniFi) –Ω–µ –∑–ª–∞–º–∞–Ω—ñ.
